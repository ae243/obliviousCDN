<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="1026.5894"
   height="607.27588"
   id="svg2"
   version="1.1"
   inkscape:version="0.92.1 r15371"
   sodipodi:docname="request_diagram_simple2.svg">
  <defs
     id="defs4">
    <marker
       inkscape:stockid="Arrow2Lend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow2Lend"
       style="overflow:visible">
      <path
         id="path3818"
         style="fill-rule:evenodd;stroke-width:0.73333335;stroke-linejoin:round"
         d="M -11.403143,-4.732916 1.416553,-0.01878889 -11.403144,4.6953372 c 2.0480517,-2.7832182 2.0362508,-6.5911436 10e-7,-9.4282532 z"
         inkscape:connector-curvature="0" />
    </marker>
  </defs>
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.47797233"
     inkscape:cx="-106.93882"
     inkscape:cy="139.67729"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="true"
     inkscape:window-width="1920"
     inkscape:window-height="1141"
     inkscape:window-x="1920"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     fit-margin-top="0"
     fit-margin-left="0"
     fit-margin-right="0"
     fit-margin-bottom="0">
    <inkscape:grid
       type="xygrid"
       id="grid2985"
       originx="-162.0221"
       originy="-405.33334"
       spacingx="1.0666667"
       spacingy="1.0666667" />
  </sodipodi:namedview>
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-162.0221,-109.91045)">
    <path
       style="fill:none;stroke:#000000;stroke-width:2.23109341;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="M 213.50648,141.18629 V 717.18631"
       id="path2987"
       inkscape:connector-curvature="0"
       inkscape:connector-type="polyline" />
    <flowRoot
       xml:space="preserve"
       id="flowRoot3761"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(-27.290398,12.553028)"><flowRegion
         id="flowRegion3763"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3765"
           width="241.01813"
           height="89.265976"
           x="187.71951"
           y="93.810593"
           style="font-size:23.46666718px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3767"
         style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:32px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif Bold';stroke-width:1.06666672">Client</flowPara></flowRoot>    <path
       style="display:inline;fill:none;stroke:#000000;stroke-width:2.23109341;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="M 619.63148,141.18629 V 717.18631"
       id="path2989"
       inkscape:connector-curvature="0"
       inkscape:connector-type="polyline" />
    <flowRoot
       xml:space="preserve"
       id="flowRoot3769"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(104.7096,14.385059)"><flowRegion
         id="flowRegion3771"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3773"
           width="437.40329"
           height="109.35083"
           x="422.4057"
           y="91.526337"
           style="font-size:29.86666679px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3775"
         style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:32px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif Bold';stroke-width:1.06666672">Exit Proxy</flowPara></flowRoot>    <path
       style="fill:none;stroke:#000000;stroke-width:2.23109341;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="M 1002.2096,141.18629 V 717.18631"
       id="path2991"
       inkscape:connector-curvature="0"
       inkscape:connector-type="polyline" />
    <flowRoot
       xml:space="preserve"
       id="flowRoot3777"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(228.37754,12.762012)"><flowRegion
         id="flowRegion3779"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3781"
           width="526.66925"
           height="107.11916"
           x="736.0816"
           y="93.60128"
           style="font-size:29.86666679px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3783"
         style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:32px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif Bold';stroke-width:1.06666672">CDN</flowPara></flowRoot>    <path
       style="fill:none;stroke:#000000;stroke-width:2.2857039;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow2Lend)"
       d="M 213.33334,333.1863 H 618.66669"
       id="path3785"
       inkscape:connector-curvature="0"
       inkscape:connector-type="polyline" />
    <path
       style="display:inline;fill:none;stroke:#000000;stroke-width:2.32808042;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow2Lend)"
       d="M 618.66669,439.85297 H 1002.6667"
       id="path3787"
       inkscape:connector-curvature="0"
       inkscape:connector-type="polyline" />
    <path
       style="fill:none;stroke:#000000;stroke-width:2.31917787;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow2Lend)"
       d="M 1002.6667,525.1863 H 618.66667"
       id="path3789"
       inkscape:connector-curvature="0"
       inkscape:connector-type="polyline" />
    <path
       style="display:inline;fill:none;stroke:#000000;stroke-width:2.228194;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow2Lend)"
       d="M 618.66669,653.18631 H 213.33334"
       id="path3791"
       inkscape:connector-curvature="0"
       inkscape:connector-type="polyline" />
    <flowRoot
       xml:space="preserve"
       id="flowRoot3004"
       style="font-style:italic;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(209.21713,-20.921714)"><flowRegion
         id="flowRegion3006"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3008"
           width="356.125"
           height="138.18547"
           x="10.657902"
           y="173.25587"
           style="font-style:italic;font-size:19.20000076px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3010"
         style="font-size:24px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672">(1) Generate session key (skey), append encrypted session key as header, encrypt URL</flowPara></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3012"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"><flowRegion
         id="flowRegion3014"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3016"
           width="147.28886"
           height="95.960922"
           x="9.5897255"
           y="143.38048"
           style="font-size:21.33333397px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3018"
         style="font-size:21.33333397px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672" /></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3041"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(-29.013879,18.921706)"><flowRegion
         id="flowRegion3043"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3045"
           width="618.49805"
           height="74.079254"
           x="243.20403"
           y="269.29138"
           style="font-size:29.86666679px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3049"
         style="font-size:26.66666603px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672">GET {URL}<flowSpan
   style="font-size:26.66666603px;font-family:sans-serif;baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3051">skey</flowSpan>, {skey}<flowSpan
   style="font-size:26.66666603px;font-family:sans-serif;baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3092">PKexit</flowSpan></flowPara></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3072"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"><flowRegion
         id="flowRegion3074"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3076"
           width="408.39182"
           height="142.82558"
           x="445.86969"
           y="373.78381"
           style="font-size:21.33333397px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3078"
         style="font-size:21.33333397px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672" /></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3080"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(378.59084,-63.345937)"><flowRegion
         id="flowRegion3082"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3084"
           width="394.8302"
           height="100.67998"
           x="249.83391"
           y="399.40027"
           style="font-size:21.33333397px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3086"
         style="font-style:italic;font-size:24px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';stroke-width:1.06666672">(2) Decrypt {skey}<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3114">PK<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:super;stroke-width:1.06666672"
   id="flowSpan3116">-1</flowSpan>exit</flowSpan>,</flowPara><flowPara
         id="flowPara3088"
         style="font-style:italic;font-size:24px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';stroke-width:1.06666672">decrypt {URL}<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3122">skey</flowSpan></flowPara></flowRoot>    <text
       xml:space="preserve"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       x="695.87634"
       y="426.6485"
       id="text3124"><tspan
         sodipodi:role="line"
         id="tspan3126"
         x="695.87634"
         y="426.6485"
         style="font-size:26.66666603px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672">GET HMAC<tspan
   style="font-size:26.66666603px;font-family:sans-serif;baseline-shift:sub;stroke-width:1.06666672"
   id="tspan3132">k</tspan>(URL)</tspan></text>
    <flowRoot
       xml:space="preserve"
       id="flowRoot3134"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"><flowRegion
         id="flowRegion3136"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3138"
           width="410.6235"
           height="151.75217"
           x="727.45923"
           y="527.38379"
           style="font-size:21.33333397px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3140"
         style="font-size:21.33333397px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672" /></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3142"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(489.53915,-101.46589)"><flowRegion
         id="flowRegion3144"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3146"
           width="488.73123"
           height="109.35083"
           x="514.23309"
           y="555.1134"
           style="font-size:21.33333397px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3148"
         style="font-style:italic;font-size:24px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';stroke-width:1.06666672">(3) Retrieve </flowPara><flowPara
         style="font-style:italic;font-size:24px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';stroke-width:1.06666672"
         id="flowPara116">{content<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3150">URL</flowSpan>}<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3152">k</flowSpan></flowPara></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3154"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(190.35865,-118.20325)"><flowRegion
         id="flowRegion3156"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3158"
           width="633.78839"
           height="145.05721"
           x="522.65283"
           y="608.4765"
           style="font-size:29.86666679px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3160"
         style="font-size:26.66666603px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672">{content<flowSpan
   style="font-size:26.66666603px;font-family:sans-serif;baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3162">URL</flowSpan>}<flowSpan
   style="font-size:26.66666603px;font-family:sans-serif;baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3164">k</flowSpan></flowPara></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3166"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(500)"><flowRegion
         id="flowRegion3168"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3170"
           width="488.73123"
           height="162.9104"
           x="490.67236"
           y="678.84039"
           style="font-size:21.33333397px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3172"
         style="font-size:21.33333397px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672" /></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3174"
       style="font-style:italic;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(135.96219,-160.04667)"><flowRegion
         id="flowRegion3176"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3178"
           width="484.26794"
           height="167.3737"
           x="491.92807"
           y="708.70837"
           style="font-style:italic;font-size:21.33333397px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3180"
         style="font-size:24px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672">(4)Decrypt {content<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3184">URL</flowSpan>}<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3186">k</flowSpan>,</flowPara><flowPara
         id="flowPara3182"
         style="font-size:24px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672">encrypt {content<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3188">URL</flowSpan>}<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3190">skey</flowSpan></flowPara></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3192"
       style="font-style:normal;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(50.212112,-146.45199)"><flowRegion
         id="flowRegion3194"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3196"
           width="604.77704"
           height="120.50906"
           x="234.67776"
           y="762.07281"
           style="font-size:29.86666679px;font-family:sans-serif;stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3198"
         style="font-size:26.66666603px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672">{content<flowSpan
   style="font-size:26.66666603px;font-family:sans-serif;baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3200">URL</flowSpan>}<flowSpan
   style="font-size:26.66666603px;font-family:sans-serif;baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3202">skey</flowSpan></flowPara></flowRoot>    <flowRoot
       xml:space="preserve"
       id="flowRoot3212"
       style="font-style:italic;font-weight:normal;font-size:12.80000019px;line-height:0.01%;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.06666672"
       transform="translate(179.92673,-150.63633)"><flowRegion
         id="flowRegion3214"
         style="font-family:sans-serif;stroke-width:1.06666672"><rect
           id="rect3216"
           width="421.78174"
           height="124.97237"
           x="42.669003"
           y="823.9151"
           style="font-style:italic;font-size:21.33333397px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';stroke-width:1.13777781" /></flowRegion><flowPara
         id="flowPara3224"
         style="font-size:24px;line-height:1.25;font-family:sans-serif;stroke-width:1.06666672">(5) Decrypt {content<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3220">URL</flowSpan>}<flowSpan
   style="font-style:italic;font-size:24px;font-family:sans-serif;-inkscape-font-specification:'Sans Italic';baseline-shift:sub;stroke-width:1.06666672"
   id="flowSpan3222">skey</flowSpan></flowPara></flowRoot>  </g>
</svg>
