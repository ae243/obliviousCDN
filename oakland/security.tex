\section{Security Analysis}
\label{sec:sec}
We analyze and discuss how \system{} addresses different attacks.  Table \ref{tab:sec_table} 
shows what security and privacy features \system{} provides in comparison to other related 
systems.

\begin{table}[t!]
\centering
\begin{tabular}{| l | c | c | c |} 
\hline
 {} & Preserves  & Preserves   & Protects \\ 
 {} & Integrity & Confidentiality & Client\\
 {} & at CDN & at CDN & Identity \\
\hline
 Stickler~\cite{levy2015stickler} & \checkmark & {} & {}\\ 
 R \& C~\cite{michalakis2007ensuring} & \checkmark & {} & {}\\
 Tor~\cite{dingledine2004tor} & {} & {} & \checkmark \\
 {\bf OCDN} & {} & {\bf \checkmark} & {\bf \checkmark} \\
\hline
\end{tabular}
\caption{The security and privacy features offered by related systems.  To our knowledge, 
\system{} is the first to address confidentiality at the CDN.}
\label{tab:sec_table}
\end{table}

{\bf Popularity Attacks.}  An attacker that has requested or otherwise 
gained access to CDN cache logs can learn information about how often 
content was requested.  Because not all content is requested uniformly, the 
attacker could potentially correlate the most commonly requested content with 
very popular webpages.  While this does not allow the CDN to learn which 
clients are accessing the content, it can reveal information about what content 
is stored on the CDN cache nodes.  \system{} handles this type of attacker by making 
the distribution of content requests appear uniform.  The content publisher (of popular 
content) generates multiple shared keys 
and encrypts their content under each key, such that they have multiple, different-looking 
copies of their content.  All of the content copies are pushed to the CDN and each key is 
shared with the exit proxies.\footnote{This also provides load balancing for exit proxies 
that hold originally held the sole key for the popular webpage, but this is now distributed 
across multiple exit proxies.}  Now, the popular content does not appear as popular, 
and it makes difficult for an attacker to infer the popularity of the content.

{\bf Chosen Plaintext Attacks.} An attacker could attempt to
determine whether a particular URL was being accessed by sending requests
through specific \system{} proxies and requesting access to the CDN cache logs, 
which contain the corresponding obfuscated
requests and responses. Blinding the clients' requests
with a random nonce that is added by the proxy should prevent against this
attack. We also believe that such an attack reflects a stronger attack: from a
law enforcement perspective, receiving a subpoena for {\em existing} logs and
data may present a lower legal barrier than compelling a CDN to attack a
system.

{\bf Spoofed Content Updates.} Because the CDN cache
nodes do not know either the content that they are hosting or the URLs
corresponding to the content, an attacker could masquerade as an origin server
and could potentially push bogus content for a URL to a cache node. There are
a number of defenses against this possible attack. This simplest solution is
for CDN cache nodes to authenticate origin servers and only accept updates
from trusted origins; this approach is plausible, since many origin servers already
have a corresponding public key certificate through the web PKI hierarchy.  An additional
defense is to make it difficult for to discover which obfuscated URLs correspond
to which content that an attacker wishes to spoof; this is achievable by design.
A third defense would be to only accept updates for content from the same origin
server that populated the cache with the original content.

{\bf Flashcrowds.}  A flashcrowd is large spike in traffic to a specific web page.  An attacker 
could see that some content on the CDN has just seen a surge in traffic and correlate that with 
other information (for example, major world events).  This leaks information about what the content the 
CDN is caching.  Fortunately, the design of \system{} can defend against this type of inference attack.  
The exit proxy can cache content in time of a flashcrowd, such that the CDN (and therefore the attacker) 
does not see the surge in traffic.  
